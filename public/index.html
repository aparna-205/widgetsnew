<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.datatables.net/1.10.20/css/dataTables.bootstrap4.min.css" rel="stylesheet" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/js/all.min.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="/style.css">
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css">
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/moment/moment.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.5.0/dist/css/bootstrap.min.css">
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.7.0/chart.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js"></script>
      <script src="https://pingendo.com/assets/bootstrap/bootstrap-4.0.0-alpha.6.min.js"></script>
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
        <script src='https://kit.fontawesome.com/a076d05399.js' crossorigin='anonymous'></script>
          <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
            <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js"></script>
      <script src="https://pingendo.com/assets/bootstrap/bootstrap-4.0.0-alpha.6.min.js"></script>
            <script src="https://cdn.jsdelivr.net/npm/gaugeJS/dist/gauge.min.js"></script>
              <script src ="https://cdn.rawgit.com/Eonasdan/bootstrap-datetimepicker/e8bddc60e73c1ec2475f827be36e1957af72e2ea/src/js/bootstrap-datetimepicker.js"></script>
                       <script src ="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.2/jquery.min.js"></script>
                       <script src ="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.9.0/moment-with-locales.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
        <script type="text/javascript" src="//cdn.jsdelivr.net/jquery/1/jquery.min.js"></script>
    <script type="text/javascript" src="//cdn.jsdelivr.net/momentjs/latest/moment.min.js"></script>
    <link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/bootstrap/3/css/bootstrap.css" />
    <script type="text/javascript" src="//cdn.jsdelivr.net/bootstrap.daterangepicker/2/daterangepicker.js"></script>
        <link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/bootstrap.daterangepicker/2/daterangepicker.css" />
        <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>
    {% block title%}{% endblock %}
</head>
<body class="sb-nav-fixed">
    <nav class="sb-topnav navbar navbar-expand navbar-dark bg-dark">
        <button class="btn btn-link btn-sm order-1 order-lg-0" id="sidebarToggle" href="#"><i class="fas fa-bars"></i></button>
        <script>
            $(document).ready(function() {
                "use strict";
        
                // Add active state to sidebar nav links
                var path = window.location.href;
                $("#layoutSidenav_nav .sb-sidenav a.nav-link").each(function() {
                    if (this.href === path) {
                        $(this).addClass("active");
                    }
                });
        
                // Toggle the side navigation
                $("#sidebarToggle").on("click", function(e) {
                    e.preventDefault();
                    $("body").toggleClass("sb-sidenav-toggled");
                });
            });
        </script>
        
    </nav>
    <div id="layoutSidenav">
        <div id="layoutSidenav_nav">
            <nav class="sb-sidenav accordion sb-sidenav-dark" id="sidenavAccordion">
                <div class="sb-sidenav-menu">
                    <div class="nav">
                        

                        <form  id="fetchForm" action="/fetch-data" method="post" class="table-container">
                            <input type="text" id="dateTimeRange" name="dateTimeRange" />
                            <div class="table-scroll">

                        <!-- Wrap the table in a div with a scrollbar -->
                            <table>
                                <thead>
                                </thead>
                                <tbody id="tableList">
                                </tbody>
                            </table>
                            </div>
                        <input type="submit" value="Fetch Data">
                    </form>
                    <script>
                        // Fetch tableNames from your server-side route (e.g., using AJAX)
                        // and insert them into the <tbody> element as an HTML table
                        fetch('/getTableNames')
                            .then(response => response.json())
                            .then(data => {
                                const tableList = document.getElementById('tableList');
                                data.tableNames.forEach(tableName => {
                                    const row = document.createElement('tr');
                                    const cell1 = document.createElement('td');
                                    const cell2 = document.createElement('td');
                                    const radio = document.createElement('input');
                                    radio.type = 'radio';
                                    radio.name = 'table';
                                    radio.value = tableName; // Set the IMEI number as the value for selection
                                    
                                    // Display the object name
                                    if (typeof imeiToObject !== 'undefined' && imeiToObject[tableName]) {
                                        cell1.textContent = imeiToObject[tableName]; // Display the object name
                                    } else {
                                        cell1.textContent = tableName; // Display the table name
                                    }
                                    cell2.appendChild(radio);
                                    row.appendChild(cell1);
                                    row.appendChild(cell2);
                                    tableList.appendChild(row);
                                });
                            })
                            .catch(error => console.error(error));
                    </script>
                        <script>
        $(document).ready(function() {
            $('#dateTimeRange').daterangepicker({
                autoUpdateInput: true,
                timePicker: true,
                timePickerIncrement: 15,
                locale: {
                    cancelLabel: 'Clear',
                    format: 'MM/DD/YYYY HH:mm',
                },
                minDate: '09/01/2023', // Set the minimum date
                maxDate: moment(),    // Set the maximum date to the current date
                ranges: {
                    'Last Week': [moment().startOf('week').subtract(1, 'week'), moment().startOf('week').subtract(1, 'second')],
                    'This Week': [moment().startOf('week'), moment()],
                    'Yesterday': [moment().subtract(1, 'days'), moment().subtract(1, 'days')],
                    'Today': [moment(), moment()],
                    'Last Month': [moment().startOf('month').subtract(1, 'month'), moment().startOf('month').subtract(1, 'second')],
                    'This Month': [moment().startOf('month'), moment()]
                }
            });        
            $('#dateTimeRange').on('apply.daterangepicker', function(ev, picker) {
                $(this).val(picker.startDate.format('MM/DD/YYYY HH:mm') + ' - ' + picker.endDate.format('MM/DD/YYYY HH:mm'));
            });       
            $('#dateTimeRange').on('cancel.daterangepicker', function() {
                $(this).val('');
            });
            $('#fetchForm').submit(function(e) {
                e.preventDefault();
                var formData = $(this).serialize();
                $.ajax({
                    type: 'POST',
                    url: '/fetch-data',
                    data: formData,
                    dataType: 'html',
                    success: function(response) {
                        $('#result-container').html(response);
                    },
                    error: function(error) {
                        console.error(error);
                    }
                });
            });
        });
        
    </script>
                    </div>
                </div>
            </nav>
        </div>
        <div id="layoutSidenav_content">
            <div id="result-container"></div>
        </div>
    </div>
</body>
</html>